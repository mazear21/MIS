{% extends 'base.html' %} {% block title %}Manage Subjects - MIS System{% endblock %} {% block
content %}
<div class="container">
  <!-- Page Header -->
  <div class="page-header">
    <div class="row align-items-center">
      <div class="col">
        <h2><i class="bi bi-journal-bookmark me-2"></i>Subject Management</h2>
        <p>Manage all subjects (5 subjects per semester)</p>
      </div>
      <div class="col-auto">
        <a href="{{ url_for('admin_add_subject') }}" class="btn btn-primary">
          <i class="bi bi-plus-lg me-1"></i>Add New Subject
        </a>
      </div>
    </div>
  </div>

  <!-- Program Info -->
  <div class="card mb-4">
    <div class="card-body">
      <div class="row text-center">
        <div class="col-md-3">
          <h3 class="text-navy mb-0">2</h3>
          <small class="text-muted">Years</small>
        </div>
        <div class="col-md-3">
          <h3 class="text-navy mb-0">4</h3>
          <small class="text-muted">Semesters</small>
        </div>
        <div class="col-md-3">
          <h3 class="text-navy mb-0">5</h3>
          <small class="text-muted">Subjects/Sem</small>
        </div>
        <div class="col-md-3">
          <h3 class="text-navy mb-0">20</h3>
          <small class="text-muted">Total Subjects</small>
        </div>
      </div>
    </div>
  </div>

  <!-- Subjects by Semester -->
  {% for cls in classes %}
  <div class="card mb-4">
    <div class="card-header">
      <i class="bi bi-calendar3 me-2"></i>{{ cls.name }} {% set semester_subjects =
      subjects|selectattr('class_id', 'equalto', cls.id)|list %}
      <span class="badge bg-white text-navy float-end"
        >{{ semester_subjects|length }}/5 Subjects</span
      >
    </div>
    <div class="card-body">
      {% if semester_subjects %}
      <div class="table-responsive">
        <table class="table table-hover mb-0">
          <thead>
            <tr>
              <th>#</th>
              <th>Subject Name</th>
              <th>Teacher</th>
              <th>Description</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            {% for subject in semester_subjects %}
            <tr>
              <td>{{ loop.index }}</td>
              <td><strong>{{ subject.name }}</strong></td>
              <td>
                {% if subject.teacher_name %}
                <span class="badge bg-navy">{{ subject.teacher_name }}</span>
                {% else %}
                <span class="badge bg-secondary">Not Assigned</span>
                {% endif %}
              </td>
              <td>{{ subject.description or '-' }}</td>
              <td>
                <a
                  href="{{ url_for('admin_edit_subject', subject_id=subject.id) }}"
                  class="btn btn-sm btn-outline-primary"
                >
                  <i class="bi bi-pencil"></i>
                </a>
                <form
                  action="{{ url_for('admin_delete_subject', subject_id=subject.id) }}"
                  method="POST"
                  class="d-inline"
                  onsubmit="return confirm('Are you sure you want to delete this subject?');"
                >
                  <button type="submit" class="btn btn-sm btn-outline-danger">
                    <i class="bi bi-trash"></i>
                  </button>
                </form>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
      {% else %}
      <p class="text-muted text-center py-3 mb-0">
        <i class="bi bi-inbox me-2"></i>No subjects added for this semester.
        <a href="{{ url_for('admin_add_subject') }}">Add subject</a>
      </p>
      {% endif %}
    </div>
  </div>
  {% endfor %} {% if not classes %}
  <div class="card">
    <div class="card-body text-center py-5">
      <i class="bi bi-calendar-x text-muted" style="font-size: 4rem"></i>
      <h5 class="mt-3">No Semesters Found</h5>
      <p class="text-muted">Please initialize the system first to create semesters.</p>
    </div>
  </div>
  {% endif %}
</div>
{% endblock %}
